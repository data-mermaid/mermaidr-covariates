<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Access covariates for MERMAID data • mermaidrcovariates</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Access covariates for MERMAID data">
<meta name="description" content="Access covariates for MERMAID data.">
<meta property="og:description" content="Access covariates for MERMAID data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mermaidrcovariates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/covariates.html">Getting environmental covariates for GFCR locations</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mermaidrcovariates">mermaidrcovariates<a class="anchor" aria-label="anchor" href="#mermaidrcovariates"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of <code>mermaidrcovariates</code> is to easily access covariates data and add it to MERMAID data.</p>
<p>For more information and detailed instructions on usage, please visit the <a href="https://data-mermaid.github.io/mermaidr-covariates/">package website</a>.</p>
<p>For more details on using <code>mermaidr</code> in general, please see the <a href="https://data-mermaid.github.io/mermaidr/" class="external-link"><code>mermaidr</code> package website</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>mermaidrcovariates</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"data-mermaid/mermaidr-covariates"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Through <code>mermaidrcovariates</code>, you can easily add covariates to the aggregated data from your coral reef surveys, which is already entered in MERMAID. To do this, first load the <code>mermaidrcovariates</code> and <code>mermaid</code> packages, and access the sample events for a given project. For this example, we will work with hard coral cover data, available from the Benthic PIT method.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://data-mermaid.github.io/mermaidr-covariates/">mermaidrcovariates</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mermaidr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">mermaid_search_my_projects</span><span class="op">(</span><span class="st">"Great Sea Reef 2019"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mermaid_get_project_data</span><span class="op">(</span><span class="st">"benthicpit"</span>, data <span class="op">=</span> <span class="st">"sampleevents"</span><span class="op">)</span></span></code></pre></div>
<p>To get covariates, we need each sample event’s date as well as its latitude and longitude. We will keep these columns along with the site name and average hard coral cover, using the <code>tidyverse</code> package for data manipulation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">se</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">site</span>, <span class="va">sample_date</span>, <span class="va">latitude</span>, <span class="va">longitude</span>, hard_coral_cover <span class="op">=</span> <span class="va">percent_cover_benthic_category_avg_hard_coral</span><span class="op">)</span></span></code></pre></div>
<p>To find which covariates are available, we use the <code><a href="reference/list_covariates.html">list_covariates()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/list_covariates.html">list_covariates</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`noaa-monthly-max-dhw`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt; - title: NOAA Degree Heating Week (DHW) - Monthly Aggregation</span></span>
<span><span class="co">#&gt; - description: </span></span>
<span><span class="co">#&gt; The NOAA Coral Reef Watch (CRW) daily global 5km satellite coral bleaching Degree Heating Week (DHW) product shows accumulated heat stress, which can lead to coral bleaching and death. The scale ranges from 0 to 20 °C-weeks. The DHW product accumulates the instantaneous bleaching heat stress, measured by CRW's Coral Bleaching HotSpot, during the most recent 12-week period. It is directly related to the timing and intensity of coral bleaching.</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; type, id, stac_version, description, links, stac_extensions, title, extent, license, keywords, providers, summaries</span></span></code></pre></div>
<p>The monthly aggregation of Degree Heating Weeks (DHW) is available. We can access this data by using its id, <code>noaa-monthly-max-dhw</code>, in the function <code><a href="reference/get_zonal_statistics.html">get_zonal_statistics()</a></code>. The <code><a href="reference/get_zonal_statistics.html">get_zonal_statistics()</a></code> function takes the site latitude and longitude, as well as the survey date, to find the data at that site for <code>n</code> days prior, then aggregates it.</p>
<p>We access the maximum DHW (of the monthly average) for the 365 days prior to the survey data, using a buffer size of 1000 metres:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_dhw</span> <span class="op">&lt;-</span> <span class="va">se</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/get_zonal_statistics.html">get_zonal_statistics</a></span><span class="op">(</span><span class="st">"noaa-monthly-max-dhw"</span>, n_days <span class="op">=</span> <span class="fl">365</span>, buffer <span class="op">=</span> <span class="fl">1000</span>, stats <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></code></pre></div>
<p>The covariates are returned in a format that need to be expanded. Once they are, you can see they contain start and end date of the data used for the covariates, the band, and the summarised value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_dhw</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">covariates</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 72 × 11</span></span>
<span><span class="co">#&gt;    site  sample_date latitude longitude hard_coral_cover covariate           </span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;date&gt;         &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;               </span></span>
<span><span class="co">#&gt;  1 BA09  2019-09-26     -17.4      178.             12.3 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  2 BA16  2019-09-27     -17.2      178.             10.7 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  3 GS03  2019-10-08     -16.4      178.             52   noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  4 BA15  2019-09-27     -17.2      178.             25   noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  5 YA02  2019-09-30     -17.0      177.             26.3 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  6 LW04  2019-09-25     -17.6      177.             11.7 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  7 IP3.5 2019-10-04     -16.4      179.             52.3 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  8 BA11  2019-09-27     -17.3      178.             23   noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;  9 GS05  2019-10-08     -16.4      178.             40.3 noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt; 10 YQ02  2019-10-03     -16.6      179.             59   noaa-monthly-max-dhw</span></span>
<span><span class="co">#&gt;    start_date end_date    band statistic value</span></span>
<span><span class="co">#&gt;    &lt;date&gt;     &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 2018-10-01 2019-09-01     1 max        8.36</span></span>
<span><span class="co">#&gt;  2 2018-10-01 2019-09-01     1 max        8.24</span></span>
<span><span class="co">#&gt;  3 2018-11-01 2019-10-01     1 max        5.96</span></span>
<span><span class="co">#&gt;  4 2018-10-01 2019-09-01     1 max        8.24</span></span>
<span><span class="co">#&gt;  5 2018-10-01 2019-09-01     1 max        8.79</span></span>
<span><span class="co">#&gt;  6 2018-10-01 2019-09-01     1 max       11.3 </span></span>
<span><span class="co">#&gt;  7 2018-11-01 2019-10-01     1 max        4.25</span></span>
<span><span class="co">#&gt;  8 2018-10-01 2019-09-01     1 max        8.57</span></span>
<span><span class="co">#&gt;  9 2018-11-01 2019-10-01     1 max        6.30</span></span>
<span><span class="co">#&gt; 10 2018-11-01 2019-10-01     1 max        8.25</span></span>
<span><span class="co">#&gt; # ℹ 62 more rows</span></span></code></pre></div>
<p>This data can be analysed along with the hard coral cover, shown in further detail in the example analysis, <a href="https://data-mermaid.github.io/mermaidr-covariates/articles/covariates.html">Getting environmental covariates for GFCR locations</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mermaidrcovariates</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sharla Gelfand <br><small class="roles"> Author, maintainer </small>   </li>
<li>Wildlife Conservation Society <br><small class="roles"> Copyright holder, funder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sharla Gelfand, Wildlife Conservation Society.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
