<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Access covariates for MERMAID data • mermaidrcovariates</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Access covariates for MERMAID data">
<meta name="description" content="Access covariates for MERMAID data.">
<meta property="og:description" content="Access covariates for MERMAID data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mermaidrcovariates</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mermaidrcovariates">mermaidrcovariates<a class="anchor" aria-label="anchor" href="#mermaidrcovariates"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of <code>mermaidrcovariates</code> is to easily access covariates data and add it to MERMAID data.</p>
<p>For more information and detailed instructions on usage, please visit the <a href="https://data-mermaid.github.io/mermaidr-covariates/">package website</a>.</p>
<p>For more details on using <code>mermaidr</code> in general, please see the <a href="https://data-mermaid.github.io/mermaidr/" class="external-link"><code>mermaidr</code> package website</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>mermaidrcovariates</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"data-mermaid/mermaidr-covariates"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Through <code>mermaidrcovariates</code>, you can easily add covariates to the aggregated data from your coral reef surveys, which is already entered in MERMAID. To do this, first load the <code>mermaidrcovariates</code> and <code>mermaid</code> packages, and access the sample events for a given project. For this example, we will work with hard coral cover data, available from the Benthic PIT method.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://data-mermaid.github.io/mermaidr-covariates/">mermaidrcovariates</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mermaidr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">mermaid_search_my_projects</span><span class="op">(</span><span class="st">"Great Sea Reef 2019"</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">mermaid_get_project_data</span><span class="op">(</span><span class="st">"benthicpit"</span>, data <span class="op">=</span> <span class="st">"sampleevents"</span><span class="op">)</span></span></code></pre></div>
<p>To get covariates, we need each sample event’s date as well as its latitude and longitude. We will keep these columns along with the site name and average hard coral cover, using the <code>tidyverse</code> package for data manipulation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="va">se</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">site</span>, <span class="va">sample_date</span>, <span class="va">latitude</span>, <span class="va">longitude</span>, hard_coral_cover <span class="op">=</span> <span class="va">percent_cover_benthic_category_avg_hard_coral</span><span class="op">)</span></span></code></pre></div>
<p>You can use the <a href="https://mermaid.prescient.earth/" class="external-link">Prescient browser</a> to find which covariates are available. To see this programatically, we use the <code><a href="reference/list_covariates.html">list_covariates()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/list_covariates.html">list_covariates</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`3e410700-2e6a-4b44-a2d3-1d829d19acb0`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: 3e410700-2e6a-4b44-a2d3-1d829d19acb0</span></span>
<span><span class="co">#&gt; - title: MEOW Boundaries</span></span>
<span><span class="co">#&gt; - description: </span></span>
<span><span class="co">#&gt; This dataset combines two separately published datasets: the "Marine Ecoregions Of the World" (MEOW; 2007) and the "Pelagic Provinces Of the World" (PPOW; 2012). These datasets were developed by Mark Spalding and colleagues in The Nature Conservancy. Alongside the individual authors, partners for the MEOW layer included WWF, Ramsar, WCS, and UNEP-WCMC. The ecoregions and pelagic provinces are broadly aligned with each other and are non-overlapping.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The MEOW dataset shows a biogeographic classification of the world's coastal and continental shelf waters, following a nested hierarchy of realms, provinces and ecoregions. It describes 232 ecoregions, which lie within 62 provinces and 12 large realms. The regions aim to capture generic patterns of biodiversity across habitats and taxa, with regions extending from the coast (intertidal zone) to the 200 m depth contour (extended beyond these waters out by a 5 km buffer).</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The PPOW dataset shows a biogeographic classification of the surface pelagic (i.e. epipelagic) waters of the world's oceans. It describes 37 pelagic provinces of the world, nested into four broad realms. A system of seven biomes are also identified ecologically, and these are spatially disjoint but united by common abiotic conditions, thereby creating physiognomically similar communities.</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; id, type, links, title, extent, license, keywords, providers, description, sci:citation, stac_version, stac_extensions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`640da5d3-530f-4b92-bbb8-07e70e386f8b`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: 640da5d3-530f-4b92-bbb8-07e70e386f8b</span></span>
<span><span class="co">#&gt; - title: ACA Benthic Habitat</span></span>
<span><span class="co">#&gt; - description: </span></span>
<span><span class="co">#&gt; Allen Coral Atlas benthic habitat classification map providing detailed geomorphic and benthic cover classifications for shallow coral reef ecosystems worldwide. The dataset is derived from satellite imagery and machine learning classification methods.</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; id, type, links, title, extent, license, keywords, providers, description, stac_version, stac_extensions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`50b810fb-5f17-4cdb-b34b-c377837e2a29`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: 50b810fb-5f17-4cdb-b34b-c377837e2a29</span></span>
<span><span class="co">#&gt; - title: Daily Sea Surface Temperature</span></span>
<span><span class="co">#&gt; - description: Sea surface temperature each day.</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; id, type, links, title, extent, license, keywords, providers, summaries, description, stac_version</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`10da4b11-c79f-4ce7-b359-0d4710a1f0fd`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: 10da4b11-c79f-4ce7-b359-0d4710a1f0fd</span></span>
<span><span class="co">#&gt; - title: Human Pressures and Climate Vulnerability</span></span>
<span><span class="co">#&gt; - description: </span></span>
<span><span class="co">#&gt; This dataset combines climate vulnerability scores and human pressure indicators for coral reefs worldwide. It integrates data from Beyer et al. (2018) on climate vulnerability and Andrello et al. (2022) on local human pressures.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Climate vulnerability scores include overall vulnerability, current niche, current year, projected future climate, thermal history, and temperature range metrics. Human pressure indicators include sedimentation, nutrients (nitrogen), coastal population within 5 km, market gravity (fishing pressure), number of ports, reef value, and cumulative human pressure index.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The dataset provides both normalized indicator values and raw values for key pressure metrics, along with regional classifications and BCU (Bioclimatic Unit) designations.</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; id, type, links, title, extent, license, keywords, providers, description, sci:citation, stac_version, stac_extensions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`ea07abba-06cf-41a8-92a3-b20eaf801ea9`</span></span>
<span><span class="co">#&gt; ###Collection</span></span>
<span><span class="co">#&gt; - id: ea07abba-06cf-41a8-92a3-b20eaf801ea9</span></span>
<span><span class="co">#&gt; - title: Land Use and Land Cover (LULC) Collection</span></span>
<span><span class="co">#&gt; - description: Land Use and Land Cover dataset collection</span></span>
<span><span class="co">#&gt; - field(s): </span></span>
<span><span class="co">#&gt; id, type, links, title, extent, license, keywords, providers, summaries, description, stac_version</span></span></code></pre></div>
<p>For this example, we will look at mean Daily Sea Surface Temperature (SST). We can access this data by using its id — <code>50b810fb-5f17-4cdb-b34b-c377837e2a29</code> — in the function <code><a href="reference/get_zonal_statistics.html">get_zonal_statistics()</a></code>. The <code><a href="reference/get_zonal_statistics.html">get_zonal_statistics()</a></code> function takes the site latitude and longitude, as well as the survey date, to find the data at that site for <code>n</code> days prior, then aggregates it.</p>
<p>We access the maximum SST (of the daily average) for the 60 days prior to the survey data, using a buffer size of 1000 metres:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_sst</span> <span class="op">&lt;-</span> <span class="va">se</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/get_zonal_statistics.html">get_zonal_statistics</a></span><span class="op">(</span><span class="st">"50b810fb-5f17-4cdb-b34b-c377837e2a29"</span>, n_days <span class="op">=</span> <span class="fl">10</span>, buffer <span class="op">=</span> <span class="fl">1000</span>, stats <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span></code></pre></div>
<p>The covariates are returned in a format that need to be expanded. Once they are, you can see they contain start and end date of the data used for the covariates, the band, and the summarised value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_sst</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">covariates</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 72 × 11</span></span>
<span><span class="co">#&gt;    site  sample_date latitude longitude hard_coral_cover</span></span>
<span><span class="co">#&gt;    &lt;chr&gt; &lt;date&gt;         &lt;dbl&gt;     &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 BA09  2019-09-26     -17.4      178.             12.3</span></span>
<span><span class="co">#&gt;  2 BA16  2019-09-27     -17.2      178.             10.7</span></span>
<span><span class="co">#&gt;  3 GS03  2019-10-08     -16.4      178.             52  </span></span>
<span><span class="co">#&gt;  4 BA15  2019-09-27     -17.2      178.             25  </span></span>
<span><span class="co">#&gt;  5 YA02  2019-09-30     -17.0      177.             26.3</span></span>
<span><span class="co">#&gt;  6 LW04  2019-09-25     -17.6      177.             11.7</span></span>
<span><span class="co">#&gt;  7 IP3.5 2019-10-04     -16.4      179.             52.3</span></span>
<span><span class="co">#&gt;  8 BA11  2019-09-27     -17.3      178.             23  </span></span>
<span><span class="co">#&gt;  9 GS05  2019-10-08     -16.4      178.             40.3</span></span>
<span><span class="co">#&gt; 10 YQ02  2019-10-03     -16.6      179.             59  </span></span>
<span><span class="co">#&gt;    covariate                            start_date end_date    band statistic</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                                &lt;date&gt;     &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;    </span></span>
<span><span class="co">#&gt;  1 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-07-28 2019-09-27     1 max      </span></span>
<span><span class="co">#&gt;  2 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-07-29 2019-09-28     1 max      </span></span>
<span><span class="co">#&gt;  3 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-08-09 2019-10-09     1 max      </span></span>
<span><span class="co">#&gt;  4 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-07-29 2019-09-28     1 max      </span></span>
<span><span class="co">#&gt;  5 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-08-01 2019-10-01     1 max      </span></span>
<span><span class="co">#&gt;  6 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-07-27 2019-09-26     1 max      </span></span>
<span><span class="co">#&gt;  7 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-08-05 2019-10-05     1 max      </span></span>
<span><span class="co">#&gt;  8 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-07-29 2019-09-28     1 max      </span></span>
<span><span class="co">#&gt;  9 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-08-09 2019-10-09     1 max      </span></span>
<span><span class="co">#&gt; 10 50b810fb-5f17-4cdb-b34b-c377837e2a29 2019-08-04 2019-10-04     1 max      </span></span>
<span><span class="co">#&gt;    value</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  27.1</span></span>
<span><span class="co">#&gt;  2  27.0</span></span>
<span><span class="co">#&gt;  3  27.5</span></span>
<span><span class="co">#&gt;  4  27.0</span></span>
<span><span class="co">#&gt;  5  27.1</span></span>
<span><span class="co">#&gt;  6  27.2</span></span>
<span><span class="co">#&gt;  7  27.7</span></span>
<span><span class="co">#&gt;  8  27.0</span></span>
<span><span class="co">#&gt;  9  27.5</span></span>
<span><span class="co">#&gt; 10  27.4</span></span>
<span><span class="co">#&gt; # ℹ 62 more rows</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mermaidrcovariates</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sharla Gelfand <br><small class="roles"> Author, maintainer </small>   </li>
<li>Wildlife Conservation Society <br><small class="roles"> Copyright holder, funder </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sharla Gelfand, Wildlife Conservation Society.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
